
config:
    name: "Cluster Nfs Test"
    base_url: ${get_cluster_url()}
    parameters:
        req_host-nfs_mode: ${P(umi_cluster/data/nfs.csv)}
    variables:
        vol_name: vol-01
    #    nfs_mode: Cluster


teststeps:
-
    name: Nfs Service Status
    request:
        method: POST
        url: "/storage/nfs/service/status"
        json: {
            "req_host": "$req_host",
            "nfs_mode": "$nfs_mode"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Nfs Service Init
    request:
        method: POST
        url: "/storage/nfs/service/init"
        json: {
            "req_host": "$req_host",
            "nfs_mode": "$nfs_mode"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Nfs Service Enable
    request:
        method: POST
        url: "/storage/nfs/service/enable"
        json: {
            "req_host": "$req_host",
            "nfs_mode": "$nfs_mode"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Nfs Share Update
    request:
        method: POST
        url: "/storage/nfs/share/update"
        json: {
            "req_host": "$req_host",
            "nfs_mode": "$nfs_mode",
            "vol_name": "$vol_name",
            "share_dir": "/subdir-01",
            "client": "172.18.123.0/24",
            "readonly": true
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Nfs Share List
    request:
        method: POST
        url: "/storage/nfs/share/list"
        json: {
            "req_host": "$req_host",
            "nfs_mode": "$nfs_mode"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Nfs Client Status
    request:
        method: POST
        url: "/storage/nfs/client/status"
        json: {
            "req_host": "$req_host"
        }
    validate:
        - eq: ["status_code", 200]

-
    name: Nfs Share Delete
    request:
        method: POST
        url: "/storage/nfs/share/delete"
        json: {
            "req_host": "$req_host",
            "nfs_mode": "$nfs_mode",
            "vol_name": "$vol_name",
            "share_dir": "/subdir-01",
            "client": "172.18.123.0/24"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Nfs Service Disable
    request:
        method: POST
        url: "/storage/nfs/service/disable"
        json: {
            "req_host": "$req_host",
            "nfs_mode": "$nfs_mode"
        }
    validate:
        - eq: ["status_code", 200]
# 暂未实现
# -
#     name: Nfs Config Export
#     request:
#         method: POST
#         url: "/storage/nfs/config/export"
#         json: {
#             "req_host": "$req_host"
#         }
#     validate:
#         - eq: ["status_code", 200]
# -
#     name: Nfs Config Import
#     request:
#         method: POST
#         url: "/storage/nfs/config/import"
#         json: {
#             "req_host": "$req_host"
#         }
#     validate:
#         - eq: ["status_code", 200]
