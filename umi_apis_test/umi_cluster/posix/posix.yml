
config:
    name: "Cluster Posix Test"
    base_url: ${get_cluster_url()}
    parameters:
        req_host: ${P(umi_cluster/data/posix.csv)}
    variables:
        vol_name: vol-01

teststeps:
-
    name: Posix Share List
    request:
        method: POST
        url: "/cluster/posix/share/list"
        json: {
            "req_host": "$req_host"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Posix Share Update
    request:
        method: POST
        url: "/cluster/posix/share/update"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name",
            "share_dir": "/tmp/$vol_name/subdir-01",
            "allow_hosts": [
              "172.18.123.0/24",
              "172.169.100.11"
            ],
            "deny_hosts": [
              "192.168.2.0/24"
            ]
        }
    validate:
        - eq: ["status_code", 200]

-
    name: Posix Client Status
    request:
        method: POST
        url: "/cluster/posix/client/status"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name"
        }
    validate:
        - eq: ["status_code", 200]

-
    name: Posix Share Delete
    request:
        method: POST
        url: "/cluster/posix/share/delete"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name",
            "share_dir": "/tmp/$vol_name/subdir-01"
        }
    validate:
        - eq: ["status_code", 200]

# 暂未实现
# -
#     name: Posix Config Export
#     request:
#         method: POST
#         url: "/cluster/posix/config/export"
#         json: {
#             "req_host": "$req_host"
#         }
#     validate:
#         - eq: ["status_code", 200]
# -
#     name: Posix Config Import
#     request:
#         method: POST
#         url: "/cluster/posix/config/import"
#         json: {
#             "req_host": "$req_host",
#             "config": "string"
#         }
#     validate:
#         - eq: ["status_code", 200]
