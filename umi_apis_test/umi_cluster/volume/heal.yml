
config:
    name: "Cluster Volume Heal Test"
    base_url: ${get_cluster_url()}
    parameters:
        req_host-host01: ${P(umi_cluster/data/storage.csv)}
    variables:
        vol_name: vol-01
        mode: Replica

teststeps:
-
    name: Cluster Volume Heal Enable
    request:
        method: POST
        url: "/cluster/volume/heal/enable"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Cluster Volume Heal Disable
    request:
        method: POST
        url: "/cluster/volume/heal/disable"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Cluster Volume Heal Full
    request:
        method: POST
        url: "/cluster/volume/heal/full"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name"
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Cluster Volume Heal Statistics
    request:
        method: POST
        url: "/cluster/volume/heal/statistics"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name"
        }
    validate:
        - eq: ["status_code", 200]
# -
#     name: Cluster Volume Heal Split Brain
#     request:
#         method: POST
#         url: "/cluster/volume/heal/split_brain"
#         json: {
#             "req_host": "$req_host",
#             "vol_name": "$vol_name"
#             "bigger_file": "",
#             "latest_mtime": "",
#             "source_brick": "$host01:/data/${get_uuid_with_uuid_mark(uuid_01)}/$vol_name",
#             "path": ""
#         }
#     validate:
#         - eq: ["status_code", 200]
-
    name: Cluster Volume Heal Info
    request:
        method: POST
        url: "/cluster/volume/heal/info"
        json: {
            "req_host": "$req_host",
            "vol_name": "$vol_name",
            "is_only_split_brain": false
        }
    validate:
        - eq: ["status_code", 200]

