config:
    name: ${ENV(umi_cluster_test_title)}
    base_url: ${ENV(umi_cluster_url)}

teststeps:

# 删除iSCSI用户 usr-01
-
    name: Iscsi User Delete
    request:
        method: POST
        url: "/cluster/iscsi/user/delete"
        json: {
            "req_host": "127.0.0.1",
            "user": "usr-01"
        }
    validate:
        - eq: ["status_code", 200]


# 删除iSCSI用户 usr-02
-
    name: Iscsi User Delete
    request:
        method: POST
        url: "/cluster/iscsi/user/delete"
        json: {
            "req_host": "127.0.0.1",
            "user": "usr-01"
        }
    validate:
        - eq: ["status_code", 200]


# 删除iSCSI用户 usr-03
-
    name: Iscsi User Delete
    request:
        method: POST
        url: "/cluster/iscsi/user/delete"
        json: {
            "req_host": "127.0.0.1",
            "user": "usr-03"
        }
    validate:
        - eq: ["status_code", 200]


# 删除Lun lun-01
-
    name: Iscsi Lun Delete
    request:
        method: POST
        url: "/cluster/iscsi/lun/delete"
        json: {
            "req_host": "127.0.0.1",
            "lun_name": "lun-01",
            "clean_data": true
        }
    validate:
        - eq: ["status_code", 200]


# 删除Lun lun-02
-
    name: Iscsi Lun Delete
    request:
        method: POST
        url: "/cluster/iscsi/lun/delete"
        json: {
            "req_host": "127.0.0.1",
            "lun_name": "lun-02",
            "clean_data": true
        }
    validate:
        - eq: ["status_code", 200]


# 删除iSCSI-Target
-
    name: Iscsi Target Delete
    request:
        method: POST
        url: "/cluster/iscsi/target/delete"
        json: {
            "req_host": "127.0.0.1",
            "iqn": "iqn.2021-08.cluster-01.target-01"
        }
    validate:
        - eq: ["status_code", 200]


