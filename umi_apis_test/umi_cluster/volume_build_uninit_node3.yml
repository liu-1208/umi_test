config:
    name: ${ENV(umi_cluster_test_title)}
    base_url: ${ENV(umi_cluster_url)}

teststeps:

# 关闭卷
-
    name: Cluster Volume Stop
    request:
        method: POST
        url: "/cluster/volume/stop"
        json: {
            "req_host": "127.0.0.1",
            "vol_name": "umi_test"
        }
    validate:
        - eq: ["status_code", 200]


# 删除卷
-
    name: Cluster Volume Delete
    request:
        method: POST
        url: "/cluster/volume/delete"
        json: {
            "req_host": "127.0.0.1",
            "vol_name": "umi_test"
        }
    validate:
        - eq: ["status_code", 200]


# 从集群移除节点，不能有卷使用该节点
-
    name: Cluster Node Remove
    request:
        method: POST
        url: "/cluster/volume/delete"
        json: {
            "req_host": "127.0.0.1",
            "node_addr": "172.169.100.71"
        }
    validate:
        - eq: ["status_code", 200]


# 从集群移除节点，不能有卷使用该节点
-
    name: Cluster Node Remove
    request:
        method: POST
        url: "/cluster/volume/delete"
        json: {
            "req_host": "127.0.0.1",
            "node_addr": "172.169.100.72"
        }
    validate:
        - eq: ["status_code", 200]


# 从集群移除节点，不能有卷使用该节点
-
    name: Cluster Node Remove
    request:
        method: POST
        url: "/cluster/volume/delete"
        json: {
            "req_host": "127.0.0.1",
            "node_addr": "172.169.100.73"
        }
    validate:
        - eq: ["status_code", 200]


# 卸载块设备并取消开机挂载
-
    name: Block Device Disable
    request:
        method: POST
        url: "/storage/block_device/disable"
        json: {
            "req_host": "127.0.0.1",
            "dev_path": "/dev/sdb1"
        }
    validate:
        - eq: ["status_code", 200]