
config:
    name: "request methods testcase with functions"
    # base_url: ${ENV(node_url)}
    base_url: ${get_node_url()}

teststeps:
-
    name: Get Timezones
    request:
        method: POST
        url: "/network/time/timezones"
        json: {}
    validate:
        - eq: ["status_code", 200]
-
    name: Get Time
    request:
        method: POST
        url: "/network/time/get"
        json: {}
    validate:
        - eq: ["status_code", 200]
-
    name: Set Time
    request:
        method: POST
        url: "/network/time/set"
        json: {
          "timezone": "Asia/Shanghai",
          "new_time": "2021-04-13T15:00:00",
          "rtc": true,
          "set_ntp": false
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Chrony Config Get
    request:
        method: POST
        url: "/network/time/ntp/get"
        json: {}
    validate:
        - eq: ["status_code", 200]
-
    name: Conf Chrony Client
    request:
        method: POST
        url: "/network/time/ntp/put"
        json: {
          "server_list": [
            "cn.pool.ntp.org",
            "192.168.1.1"
           ],
           "allow_subnet": "0.0.0.0/0"
        }
    # 由于 put 并返回结果后，后台实际存在还在执行的可能，所以这里等待3秒
    teardown_hooks:
        - ${sleep(3)}
    validate:
        - eq: ["status_code", 200]
-
    name: Chronyc Makestep
    request:
        method: POST
        url: "/network/time/ntp/ntpdate"
        json: {}
    validate:
        - eq: ["status_code", 200]




















