
config:
    name: "request methods testcase with functions"
    base_url: ${get_node_url()}
    # parameters:
    #     host01: ${P(umi_node/data/storage.csv)}
    variables:
        host01: "${get_host_once(host01)}"
        vol_name: pytest-vol-01

teststeps:
-
    name: Gluster Peer Probe
    testcase: umi_node/glusterfs/module/gluster_peer_probe.yml

-
    name: Gluster Volume Create Single
    setup_hooks:
        - ${pytest_volume_clean($vol_name)}
    request:
        method: POST
        url: "/gluster/volume/create"
        json: {
          "vol_name": "$vol_name",
          "bricks": [
            "$host01:/data/${get_uuid_with_uuid_mark(uuid_01)}/$vol_name"
          ],
          "replica": 1,
          "arbiter": 0,
          "disperse_data": 0,
          "redundancy": 0,
          "transport": "tcp",
          "force": true
        }
    validate:
        - eq: ["status_code", 200]
-
    name: Gluster Volume Start
    request:
        method: POST
        url: "/gluster/volume/start"
        json: {
          "vol_name": "$vol_name",
          "force": true
        }
    validate:
        - eq: ["status_code", 200]


