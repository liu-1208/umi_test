
config:
    name: "request methods testcase with functions"
    # base_url: ${ENV(node_url)}
    base_url: ${get_node_url()}
    parameters:
        host_ip_01-host_ip_02: ${P(umi_node/data/glusterfs.csv)}
        host01-host02: ${P(umi_node/data/storage.csv)}

teststeps:
# -
#    name: Gluster Volume Create Multiple
#    testcase: umi_node/glusterfs/module/volume_create_replica.yml
-
   name: Gluster Volume Create Base
   testcase: umi_node/glusterfs/module/volume_create_base.yml
-
    name: Gluster Volume Heal Enable
    request:
        method: POST
        url: "/gluster/volume/heal/enable"
        json: {
          "vol_name": "pytest-vol-01"
        }
    validate:
        - eq: ["status_code", 200]

-
    name: Gluster Volume Heal Full
    request:
        method: POST
        url: "/gluster/volume/heal/full"
        json: {
          "vol_name": "pytest-vol-01"
        }
    validate:
        - eq: ["status_code", 200]

-
    name: Gluster Volume Heal Info
    request:
        method: POST
        url: "/gluster/volume/heal/info"
        json: {
          "vol_name": "pytest-vol-01",
          "only_split_brain": false
        }
    validate:
        - eq: ["status_code", 200]
# Statistics 接口已经被删掉了
# -
#     name: Gluster Volume Heal Statistics
#     request:
#         method: POST
#         url: "/gluster/volume/heal/statistics"
#         json: {
#           "vol_name": "pytest-vol-01"
#         }
#     validate:
#         - eq: ["status_code", 200]
# -
#     name: Gluster Volume Heal Split Brain
#     request:
#         method: POST
#         url: "/gluster/volume/heal/split/brain"
#         json: {
#           "vol_name": "pytest-vol-01",
#           "bigger_file": "",
#           "latest_mtime": "",
#           "source_brick": "z-01:/data/c19a3b5e-366d-4482-9fdb-9cfefbe8b800",
#           "path": ""
#         }
#     validate:
#         - eq: ["status_code", 200]

-
    name: Gluster Volume Heal Disable
    request:
        method: POST
        url: "/gluster/volume/heal/disable"
        json: {
          "vol_name": "pytest-vol-01"
        }
    validate:
        - eq: ["status_code", 200]

-
    name: Gluster Volume Delete
    testcase: umi_node/glusterfs/module/volume_delete.yml
    
